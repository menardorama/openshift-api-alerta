#!/bin/bash

echo "Config settings..."

cat >${OPENSHIFT_DATA_DIR}/alertad.conf << EOF
SECRET_KEY = '$OPENSHIFT_SECRET_TOKEN'

MONGO_HOST = '${OPENSHIFT_MONGODB_IP}'
MONGO_PORT = ${OPENSHIFT_MONGODB_PORT}
MONGO_DATABASE = '${OPENSHIFT_APP_NAME}'
MONGO_USERNAME = ''
MONGO_PASSWORD = ''

AUTH_REQUIRED = $AUTH_REQUIRED
OAUTH2_CLIENT_ID = '$CLIENT_ID'
OAUTH2_CLIENT_SECRET = '$CLIENT_SECRET'
ALLOWED_EMAIL_DOMAINS = ['${ALLOWED_EMAIL_DOMAIN:-*}']
ALLOWED_GITHUB_ORGS = ['${ALLOWED_GITHUB_ORG:-*}']

PLUGINS = ['reject','geoip']
EOF

cat ${OPENSHIFT_DATA_DIR}/alertad.conf

export ALERTA_SVR_CONFIG_FILE=${OPENSHIFT_DATA_DIR}/alertad.conf
